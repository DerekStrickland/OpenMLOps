# MLOps Reference Architecture

The MLOps reference architecture is a set of open-source tools carefully chosen to ease user experience of experimenting and deploying machine learning models. 

In this repository, we provide these applications as Terraform modules with which the user will be able to install them into a Kubernetes cluster. 
The tools we provide are the following:
- Prefect for data flow automation
- Jupyter Hub for experimenting lab
- Dask for distributed computing
- Feast for Feature Store and Serving
- MLFlow for model registry and experiment tracking
- Seldon for model deployment

![GitHub Logo](https://global-uploads.webflow.com/5d3ec351b1eba4332d213004/6001c1daafa02889e5389a59_EE2q1dQqp2fmiaXGX5vuaVVnTPXmKlmD3BC1dp90YrPB2TOiHWSq3RCCmC39MzsmYHUrQFXVK9nmTf4haQ0dIj-vdk_we67e1SR5yqEWPTuEAApuiNOXOgdr7mSefSmlZxSwu0JB.png)



# Modules
- [Jupyter Hub](#Jupyter-Hub)
- [Prefect](#Prefect)
- [Dask](#Dask)
- [MLFlow](#MLFlow)
- [Feast](#Feast)
- [Seldon](#Seldon)



## Jupyter Hub

With the Jupyter Hub, we enabled a multi-user environment in which each of them can spawn a Jupyter server to do their experiments. Users can work on different environments being able to install any library necessary to meet their needs.

We also provide a default Jupyter server image that comes with most of the data science packages installed.


### Configuration

Below we provide a lists the configurable parameters available and its default values.


| Parameter (* *required parameter*)       | Description | Default
| --- | --- |---- |
| `jupyterhub_namespace`     | Namespace to install jupyterhb     | `jhub`     |


#### Proxy configuration

The proxy receives the requests from the client’s browser and forwards all requests to the Hub. [In the JupyterHub docs](https://jupyterhub.readthedocs.io/en/stable/getting-started/security-basics.html) can find a more in-depth explanation.

*\* Required parameters*

| Parameter| Description | Default
| --- | --- |--- |
| `jhub_proxy_https_enabled` | Indicator to set whether HTTPS should be enabled or not on the proxy | `true` |
| `jhub_proxy_https_hosts`   | You domains in list form. Required for automatic HTTPS | `[]` |
| `jhub_proxy_secret_token *`  | A 32-byte cryptographically secure randomly generated string used to secure communications between the hub and the configurable-http-proxy (for example, generated by `openssl rand -hex 32`) | `nil` |
| `jhub_proxy_https_letsencrypt_contact_email` | The contact email to be used for automatically provisioned HTTPS certificates by Let’s Encrypt | `""`|

#### Authentication configuration

JupyterHub’s OAuthenticator has support for enabling your users to authenticate via a third-party OAuth2 identity provider such as GitHub, Google, and CILogon.

You can configure authentication using GitHub accounts and restrict what users are authorized based on membership of a GitHub organization.

[See details on how to set up a GitHub Oauth here.](https://zero-to-jupyterhub.readthedocs.io/en/stable/administrator/authentication.html#github)


If you choose not to use GitHub to authenticate users, the [DummyAuthenticator](https://tljh.jupyter.org/en/latest/howto/auth/dummy.html) will be used as default. The Dummy Authenticator lets any user log in with the given password.

The dummy password is: `a-shared-secret-password`.



*\* Required parameters*
*\*\* Required when `oauth_github_enable` is enabled*

| Parameter| Description | Default
| --- | --- |--- |
| `oauth_github_enable` | Defines whether the authentication will be handled by github oauth. Required when `oauth_github_enable` is enabled| `false` |
| `oauth_github_client_id **` | Github client id used on GitHubOAuthenticator. | `""`|
| `oauth_github_client_secret **`| Github secret used to authenticate with github. |  `""`|
| `oauth_github_admin_users`| List of github user names to allow as administrator| `[]`|
| `oauth_github_callback_url`| The URL that people are redirected to after they authorize your GitHub App to act on their behalf | `""`|
| `oauth_github_allowed_organizations`|List of Github organization to restrict access to the members | `[""]`|


#### User configuration

Single user configuration refers to the default settings for each user logged in the JupyterHub.

A user can choose a Docker image to spawn a new Jupyter server. Each Docker image can have different libraries and environments installed. We use the `singleuser_profile_list` parameter to set up a list of default images available to the user. This parameter receives a list of maps that describes the image details such as the image location and description.

See an example:
```
[{
  display_name = "Prefect"
  description  = "Notebook with prefect installed"
  default      = true
  kubespawner_override = {
    image = "drtools/prefect:notebook-prefect"
  }
}]

```
You must pass the image pull secret if you provide an image located in a private container registry. The image pull secret parameter is defined as below:
```
default = [{
    name   name = ""
}]
```


| Parameter| Description | Default
| --- | --- |--- |
| `singleuser_profile_list` | List of images which the user can select to spawn a server| |
| `singleuser_image_pull_secrets` | List of image secrets |  nil |
| `singleuser_image_pull_policy` | Image pull policy | `Always` |
| `singleuser_memory_guarantee` | How much memory will be guarateed to the user| `1G`|
| `singleuser_storage_capacity` | `How much storage capacity a user will have` | `1G`|
| `singleuser_storage_mount_path` | Storage mount path | `/home/jovyan/persistent` |


## Prefect
...
## Dask
...
## Feast
...
## MLFlow
...
## Seldon
...
...










...
...















...
...
